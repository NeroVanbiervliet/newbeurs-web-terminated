<%@page import="java.sql.Date"%>
<%@ page import="supportClasses.DatabaseInteraction" %>
<%@ page import="supportClasses.OakDatabaseException" %>
<%

// login expiry time
int milliSecondsTillLoginExpired = 10000;

// check if there is a post request
String postOrigin = request.getParameter("postOrigin");
if(postOrigin == null)
{
	// no post request
	// check if login is not expired
	
}
else if(postOrigin.equals("login_form"))
{
	String account = request.getParameter("account");
	String password = request.getParameter("password");
	
	// NEED account aanpassen naar webapp, python acc moet python worden
	DatabaseInteraction dbInt = new DatabaseInteraction("backtest_real");
	
	boolean isCorrect;
	try 
	{
		isCorrect = dbInt.isCorrectPassword(account, password);
	} 
	catch (OakDatabaseException e) // usernaam is niet gevonden in de database
	{
		isCorrect = false;
	}
	
	// session variables setten
	if(isCorrect)
	{
		request.getSession().setAttribute("loggedInUserName", account);
		request.getSession().setAttribute("loggedInTimestamp", System.currentTimeMillis() % 1000);
	}
	else
	{
		request.getSession().removeAttribute("loggedInUserName");
		request.getSession().removeAttribute("loggedInTimestamp");
	}
	
}

%>